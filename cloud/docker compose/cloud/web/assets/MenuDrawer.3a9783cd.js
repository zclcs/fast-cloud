var e,t=Object.defineProperty,o=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,n=(e,o,l)=>o in e?t(e,o,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[o]=l,r=(e,t,o)=>new Promise(((l,a)=>{var n=e=>{try{i(o.next(e))}catch(t){a(t)}},r=e=>{try{i(o.throw(e))}catch(t){a(t)}},i=e=>e.done?l(e.value):Promise.resolve(e.value).then(n,r);i((o=o.apply(e,t)).next())}));import{f as i,g as s}from "./useForm.bb6fa296.js";import{ai as d,bp as u,B as p,r as c,j as m,u as f,$ as b,D as v,a0 as h,a4 as y,w,a3 as g}from "./vendor.4c4242b5.js";/* empty css              */import{aJ as S,aK as I,_ as P}from "./index.446d454d.js";import{a as x}from "./system.78153014.js";import{B,a as j}from "./index.d55bbd60.js";(e||(e={})).MENU="/system/menu";const M= t=>S.delete({url:e.MENU+"/"+t}),N=[{title:"菜单名称",dataIndex:"label",width:200,align:"left"},{title:"图标",dataIndex:"icon",width:50,customRender:({record:e})=>d(P,{icon:e.icon})},{title:"权限标识",dataIndex:"perms",width:180},{title:"菜单类型",dataIndex:"type",width:80,customRender:({record:e})=>{const t=e.type;return d(u,{color:O(t)},(()=>R(t)))}},{title:"组件",dataIndex:"component"},{title:"排序",dataIndex:"orderNum",width:50},{title:"创建时间",dataIndex:"createTime",width:180}],O= e=>"2"===e?"yellow":"0"===e?"green":"blue",R= e=>"2"===e?"目录":"0"===e?"菜单":"按钮",D= e=>"0"===e,F= e=>"1"===e,T=[{field:"menuName",label:"菜单名称",component:"Input",colProps:{span:8}}],_=[{field:"type",label:"菜单类型",component:"RadioButtonGroup",defaultValue:"0",componentProps:({formActionType:e,formModel:t})=>({options:[{label:"目录",value:"2"},{label:"菜单",value:"0"},{label:"按钮",value:"1"}],onChange:()=>r(this,null,(function*(){const{updateSchema:o}=e;o({field:"label",label:R(t.type)+"名称"})}))}),colProps:{lg:24,md:24}},{field:"label",label:"菜单名称",component:"Input",required:!0},{field:"parentId",label:"上级菜单",component:"ApiTreeSelect",componentProps:{api:x,replaceFields:{title:"label",key:"id",value:"id"},getPopupContainer:()=>document.body},ifShow:({values:e})=>!("2"===e.type)},{field:"orderNum",label:"排序",component:"InputNumber",required:!0,ifShow:({values:e})=>!F(e.type)},{field:"icon",label:"图标",component:"IconPicker",required:!0,ifShow:({values:e})=>!F(e.type)},{field:"path",label:"路由地址",component:"Input",required:!0,ifShow:({values:e})=>!F(e.type)},{field:"component",label:"组件路径",component:"Input",ifShow:({values:e})=>D(e.type)},{field:"redirect",label:"重定向的子菜单",component:"Input",ifShow:({values:e})=>!F(e.type)},{field:"perms",label:"权限标识",component:"Input",required:!0,ifShow:({values:e})=>F(e.type)},{field:"ignoreKeepAlive",label:"是否忽略缓存",component:"RadioButtonGroup",defaultValue:"0",componentProps:{options:[{label:"是",value:"1"},{label:"否",value:"0"}]},ifShow:({values:e})=>D(e.type)},{field:"hideMenu",label:"是否隐藏菜单",component:"RadioButtonGroup",defaultValue:"0",componentProps:{options:[{label:"是",value:"1"},{label:"否",value:"0"}]},ifShow:({values:e})=>!F(e.type)},{field:"hideBreadcrumb",label:"是否隐藏面包屑显示",component:"RadioButtonGroup",defaultValue:"0",componentProps:{options:[{label:"是",value:"1"},{label:"否",value:"0"}]},ifShow:({values:e})=>!F(e.type)},{field:"hideChildrenInMenu",label:"是否隐藏所有子菜单",component:"RadioButtonGroup",defaultValue:"0",componentProps:{options:[{label:"是",value:"1"},{label:"否",value:"0"}]},ifShow:({values:e})=>!F(e.type)},{field:"currentActiveMenu",label:"当前激活的菜单",component:"Input",ifShow:({values:e})=>!F(e.type)}];var C=p({name:"MenuDrawer",components:{BasicDrawer:B,BasicForm:i},emits:["success","register"],setup(t, {emit:i}){const d=c(!0),u=c(""),[p,{resetFields:b,setFieldsValue:v,updateSchema:h,validate:y}]=s({labelWidth:100,schemas:_,showActionButtonGroup:!1,baseColProps:{lg:12,md:24}}),[w,{setDrawerProps:g,closeDrawer:P}]=j((e=>r(this,null,(function*(){b(),g({confirmLoading:!1}),d.value=!!(null==e?void 0:e.isUpdate),f(d)&&(u.value=e.record.id,v(((e, t)=>{for(var r in t||(t={}))l.call(t,r)&&n(e,r,t[r]);if(o)for(var r of o(t))a.call(t,r)&&n(e,r,t[r]);return e})({},e.record)));const t=yield x();h({field:"parentId",componentProps:{treeData:t}});const{type:r}=e.record;h({field:"label",label:("2"===r?"目录":"0"===r?"菜单":"按钮")+"名称"})}))));return{registerDrawer:w,registerForm:p,getTitle:m((()=>f(d)?"编辑菜单":"新增菜单")),handleSubmit:function(){return r(this,null,(function*(){try{const o=yield y();g({confirmLoading:!0}),o.menuName=o.label,o.label=void 0,f(d)?(o.menuId=u.value,yield(t=o,S.put({url:e.MENU,headers:{"Content-Type":I.JSON},data:t}))):yield(t=>S.post({url:e.MENU,headers:{"Content-Type":I.JSON},data:t}))(o),P(),i("success")}finally{g({confirmLoading:!1})}var t}))}}}});C.render=function(e, t, o, l, a, n){const r=b("BasicForm"),i=b("BasicDrawer");return v(),h(i,g(e.$attrs,{onRegister:e.registerDrawer,showFooter:"",title:e.getTitle,width:"50%",onOk:e.handleSubmit}),{default:y((()=>[w(r,{onRegister:e.registerForm},null,8,["onRegister"])])),_:1},16,["onRegister","title","onOk"])};var G=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:C});export{G as M,C as _,N as c,M as d,T as s};
