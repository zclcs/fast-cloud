version: '3'

services:
  auth:
    image: ${CLOUD_DEPOSITORY_URL}/auth:${CLOUD_DEPOSITORY_TAG}
    container_name: auth
    network_mode: host
    command: sh -c "java ${AUTH_JAVA_OPS} -cp /app/resources:/app/classes:/app/libs/* ${AUTH_MAIN_CLASS}"
    volumes:
      - ./log/auth:/log/auth
      - ./log/auth/skywalking:/agent/logs
      - ${CLOUD_AGENT_CONFIG}
    healthcheck:
      test: [ "CMD-SHELL", "curl -sS 'http://${NACOS_HOST}:${PORT_AUTH}' || exit 1" ]
      interval: ${DOCKER_HEALTHCHECK_INTERVAL}
      timeout: ${DOCKER_HEALTHCHECK_TIMEOUT}
      retries: ${DOCKER_HEALTHCHECK_RETRIES}
    env_file: .env